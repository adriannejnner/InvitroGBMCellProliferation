Dense_us_0point0001_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_0point0001_rep1\Dense_us_0point0001_rep1.mat');
Dense_us_0point0001_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_0point0001_rep2\Dense_us_0point0001_rep2.mat');
Dense_us_0point001_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_0point001_rep1\Dense_us_0point001_rep1.mat');
Dense_us_0point001_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_0point001_rep2\Dense_us_0point001_rep2.mat');
Dense_us_0point01_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_0point01_rep1\Dense_us_0point01_rep1.mat');
Dense_us_0point01_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_0point01_rep2\Dense_us_0point01_rep2.mat');
Dense_us_0point1_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_0point1_rep1\Dense_us_0point1_rep1.mat');
Dense_us_0point1_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_0point1_rep2\Dense_us_0point1_rep2.mat');
Dense_us_1_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_1_rep1\Dense_us_1_rep1.mat');
Dense_us_1_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Dense_us_1_rep2\Dense_us_1_rep2.mat');

Sparse_us_0point0001_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_0point0001_rep1\Sparse_us_0point0001_rep1.mat');
Sparse_us_0point0001_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_0point0001_rep2\Sparse_us_0point0001_rep2.mat');
Sparse_us_0point001_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_0point001_rep1\Sparse_us_0point001_rep1.mat');
Sparse_us_0point001_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_0point001_rep2\Sparse_us_0point001_rep2.mat');
Sparse_us_0point01_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_0point01_rep1\Sparse_us_0point01_rep1.mat');
Sparse_us_0point01_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_0point01_rep2\Sparse_us_0point01_rep2.mat');
Sparse_us_0point1_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_0point1_rep1\Sparse_us_0point1_rep1.mat');
Sparse_us_0point1_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_0point1_rep2\Sparse_us_0point1_rep2.mat');
Sparse_us_1_rep1 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_1_rep1\Sparse_us_1_rep1.mat');
Sparse_us_1_rep2 = load('C:\Users\adria\PhysiCell_V.1.6.0 GBM-OV project\PhysiCell-GBM-OV project\matlab\Heterogeneous_rep_sims\us\Sparse_us_1_rep2\Sparse_us_1_rep2.mat');

dense_initial_cell_number = Dense_us_0point0001_rep1.live_cells(1);
sparse_initial_cell_number = Sparse_us_0point0001_rep1.live_cells(1);

figure
hold on 
plot(linspace(0,72,36),Dense_us_0point0001_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point001_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point01_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point1_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_1_rep1.dead_cells(1:36),'LineWidth',2)
legend('u_s = 0.0001','u_s = 0.001','u_s = 0.01','u_s = 0.1','u_s = 1')
xlabel('Time (hours')
ylabel('Dead cells')
set(gca,'FontSize',18)


figure
hold on 
plot(linspace(0,72,36),Dense_us_0point0001_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point001_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point01_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point1_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_1_rep1.dead_cells(1:36),'LineWidth',2)
legend('u_s = 0.0001','u_s = 0.001','u_s = 0.01','u_s = 0.1','u_s = 1')
xlabel('Time (hours)')
ylabel('Dead cells')
set(gca,'FontSize',18)
title('Dense')



figure
hold on 
plot(linspace(0,72,36),Dense_us_0point0001_rep1.live_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point001_rep1.live_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point01_rep1.live_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_0point1_rep1.live_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Dense_us_1_rep1.live_cells(1:36),'LineWidth',2)
legend('u_s = 0.0001','u_s = 0.001','u_s = 0.01','u_s = 0.1','u_s = 1')
xlabel('Time (hours)')
ylabel('GBM cells (uninfected+infected)')
set(gca,'FontSize',18)
title('Dense')


figure
hold on 
plot(linspace(0,72,36),Sparse_us_0point0001_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Sparse_us_0point001_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Sparse_us_0point01_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Sparse_us_0point1_rep1.dead_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Sparse_us_1_rep1.dead_cells(1:36),'LineWidth',2)
legend('u_s = 0.0001','u_s = 0.001','u_s = 0.01','u_s = 0.1','u_s = 1')
xlabel('Time (hours)')
ylabel('Dead cells')
set(gca,'FontSize',18)
title('Sparse')



figure
hold on 
plot(linspace(0,72,36),Sparse_us_0point0001_rep1.live_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Sparse_us_0point001_rep1.live_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Sparse_us_0point01_rep1.live_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Sparse_us_0point1_rep1.live_cells(1:36),'LineWidth',2)
plot(linspace(0,72,36),Sparse_us_1_rep1.live_cells(1:36),'LineWidth',2)
legend('u_s = 0.0001','u_s = 0.001','u_s = 0.01','u_s = 0.1','u_s = 1')
xlabel('Time (hours)')
ylabel('GBM cells (uninfected+infected)')
set(gca,'FontSize',18)
title('Sparse')


figure
hold on 
yyaxis left
plot([0.0001 0.001 0.01 0.1 1],[...
    mean(Dense_us_0point0001_rep1.live_cells(36),Dense_us_0point0001_rep2.live_cells(36)),...
    mean(Dense_us_0point001_rep1.live_cells(36),Dense_us_0point001_rep2.live_cells(36)),...
    mean(Dense_us_0point01_rep1.live_cells(36),Dense_us_0point01_rep2.live_cells(36)),...
    mean(Dense_us_0point1_rep1.live_cells(36),Dense_us_0point1_rep2.live_cells(36)),...
    mean(Dense_us_1_rep1.live_cells(36),Dense_us_1_rep2.live_cells(36))]/dense_initial_cell_number*100,':','LineWidth',2)
l1 = errorbar([0.0001 0.001 0.01 0.1 1],[...
    mean(Dense_us_0point0001_rep1.live_cells(36),Dense_us_0point0001_rep2.live_cells(36)),...
    mean(Dense_us_0point001_rep1.live_cells(36),Dense_us_0point001_rep2.live_cells(36)),...
    mean(Dense_us_0point01_rep1.live_cells(36),Dense_us_0point01_rep2.live_cells(36)),...
    mean(Dense_us_0point1_rep1.live_cells(36),Dense_us_0point1_rep2.live_cells(36)),...
    mean(Dense_us_1_rep1.live_cells(36),Dense_us_1_rep2.live_cells(36))]/dense_initial_cell_number*100,[....
    std([Dense_us_0point0001_rep1.live_cells(36),Dense_us_0point0001_rep2.live_cells(36)]),...
    std([Dense_us_0point001_rep1.live_cells(36),Dense_us_0point001_rep2.live_cells(36)]),...
    std([Dense_us_0point01_rep1.live_cells(36),Dense_us_0point01_rep2.live_cells(36)]),...
    std([Dense_us_0point1_rep1.live_cells(36),Dense_us_0point1_rep2.live_cells(36)]),...
    std([Dense_us_1_rep1.live_cells(36),Dense_us_1_rep2.live_cells(36)])]/dense_initial_cell_number*100,'o','LineWidth',2,'MarkerSize',7)
ylabel('% Initial GBM cells ')
yyaxis right
plot([0.0001 0.001 0.01 0.1 1],[...
    mean(Sparse_us_0point0001_rep1.live_cells(36),Sparse_us_0point0001_rep2.live_cells(36)),...
    mean(Sparse_us_0point001_rep1.live_cells(36),Sparse_us_0point001_rep2.live_cells(36)),...
    mean(Sparse_us_0point01_rep1.live_cells(36),Sparse_us_0point01_rep2.live_cells(36)),...
    mean(Sparse_us_0point1_rep1.live_cells(36),Sparse_us_0point1_rep2.live_cells(36)),...
    mean(Sparse_us_1_rep1.live_cells(36),Sparse_us_1_rep2.live_cells(36))]/sparse_initial_cell_number*100,':','LineWidth',2)
l2 = errorbar([0.0001 0.001 0.01 0.1 1],[...
    mean(Sparse_us_0point0001_rep1.live_cells(36),Sparse_us_0point0001_rep2.live_cells(36)),...
    mean(Sparse_us_0point001_rep1.live_cells(36),Sparse_us_0point001_rep2.live_cells(36)),...
    mean(Sparse_us_0point01_rep1.live_cells(36),Sparse_us_0point01_rep2.live_cells(36)),...
    mean(Sparse_us_0point1_rep1.live_cells(36),Sparse_us_0point1_rep2.live_cells(36)),...
    mean(Sparse_us_1_rep1.live_cells(36),Sparse_us_1_rep2.live_cells(36))]/sparse_initial_cell_number*100,[...
    std([Sparse_us_0point0001_rep1.live_cells(36),Sparse_us_0point0001_rep2.live_cells(36)]),...
    std([Sparse_us_0point001_rep1.live_cells(36),Sparse_us_0point001_rep2.live_cells(36)]),...
    std([Sparse_us_0point01_rep1.live_cells(36),Sparse_us_0point01_rep2.live_cells(36)]),...
    std([Sparse_us_0point1_rep1.live_cells(36),Sparse_us_0point1_rep2.live_cells(36)]),...
    std([Sparse_us_1_rep1.live_cells(36),Sparse_us_1_rep2.live_cells(36)])]/sparse_initial_cell_number*100,'o','LineWidth',2,'MarkerSize',7)
set(gca,'xscale','log')
xlabel('Stroma uptake rate, u_s')
ylabel('% Initial GBM cells ')
set(gca,'FontSize',18)
legend([l1 l2],{'Dense','Sparse'})


figure
hold on 
yyaxis left
plot([0.0001 0.001 0.01 0.1 1],[...
    mean(Dense_us_0point0001_rep1.live_cells(36),Dense_us_0point0001_rep2.live_cells(36)),...
    mean(Dense_us_0point001_rep1.live_cells(36),Dense_us_0point001_rep2.live_cells(36)),...
    mean(Dense_us_0point01_rep1.live_cells(36),Dense_us_0point01_rep2.live_cells(36)),...
    mean(Dense_us_0point1_rep1.live_cells(36),Dense_us_0point1_rep2.live_cells(36)),...
    mean(Dense_us_1_rep1.live_cells(36),Dense_us_1_rep2.live_cells(36))],':','LineWidth',2)
l1 = errorbar([0.0001 0.001 0.01 0.1 1],[...
    mean(Dense_us_0point0001_rep1.live_cells(36),Dense_us_0point0001_rep2.live_cells(36)),...
    mean(Dense_us_0point001_rep1.live_cells(36),Dense_us_0point001_rep2.live_cells(36)),...
    mean(Dense_us_0point01_rep1.live_cells(36),Dense_us_0point01_rep2.live_cells(36)),...
    mean(Dense_us_0point1_rep1.live_cells(36),Dense_us_0point1_rep2.live_cells(36)),...
    mean(Dense_us_1_rep1.live_cells(36),Dense_us_1_rep2.live_cells(36))],[....
    std([Dense_us_0point0001_rep1.live_cells(36),Dense_us_0point0001_rep2.live_cells(36)]),...
    std([Dense_us_0point001_rep1.live_cells(36),Dense_us_0point001_rep2.live_cells(36)]),...
    std([Dense_us_0point01_rep1.live_cells(36),Dense_us_0point01_rep2.live_cells(36)]),...
    std([Dense_us_0point1_rep1.live_cells(36),Dense_us_0point1_rep2.live_cells(36)]),...
    std([Dense_us_1_rep1.live_cells(36),Dense_us_1_rep2.live_cells(36)])],'o','LineWidth',2,'MarkerSize',7)
ylabel('Number GBM cells at 72 hrs ')
yyaxis right
plot([0.0001 0.001 0.01 0.1 1],[...
    mean(Sparse_us_0point0001_rep1.live_cells(36),Sparse_us_0point0001_rep2.live_cells(36)),...
    mean(Sparse_us_0point001_rep1.live_cells(36),Sparse_us_0point001_rep2.live_cells(36)),...
    mean(Sparse_us_0point01_rep1.live_cells(36),Sparse_us_0point01_rep2.live_cells(36)),...
    mean(Sparse_us_0point1_rep1.live_cells(36),Sparse_us_0point1_rep2.live_cells(36)),...
    mean(Sparse_us_1_rep1.live_cells(36),Sparse_us_1_rep2.live_cells(36))],':','LineWidth',2)
l2 = errorbar([0.0001 0.001 0.01 0.1 1],[...
    mean(Sparse_us_0point0001_rep1.live_cells(36),Sparse_us_0point0001_rep2.live_cells(36)),...
    mean(Sparse_us_0point001_rep1.live_cells(36),Sparse_us_0point001_rep2.live_cells(36)),...
    mean(Sparse_us_0point01_rep1.live_cells(36),Sparse_us_0point01_rep2.live_cells(36)),...
    mean(Sparse_us_0point1_rep1.live_cells(36),Sparse_us_0point1_rep2.live_cells(36)),...
    mean(Sparse_us_1_rep1.live_cells(36),Sparse_us_1_rep2.live_cells(36))],[...
    std([Sparse_us_0point0001_rep1.live_cells(36),Sparse_us_0point0001_rep2.live_cells(36)]),...
    std([Sparse_us_0point001_rep1.live_cells(36),Sparse_us_0point001_rep2.live_cells(36)]),...
    std([Sparse_us_0point01_rep1.live_cells(36),Sparse_us_0point01_rep2.live_cells(36)]),...
    std([Sparse_us_0point1_rep1.live_cells(36),Sparse_us_0point1_rep2.live_cells(36)]),...
    std([Sparse_us_1_rep1.live_cells(36),Sparse_us_1_rep2.live_cells(36)])],'o','LineWidth',2,'MarkerSize',7)
set(gca,'xscale','log')
xlabel('Stroma uptake rate, u_s')
ylabel('Number GBM cells at 72 hrs')
set(gca,'FontSize',18)
legend([l1 l2],{'Dense','Sparse'})

figure
hold on 
yyaxis left
plot([0.0001 0.001 0.01 0.1 1],[...
    mean(Dense_us_0point0001_rep1.uninfected_cells(36),Dense_us_0point0001_rep2.uninfected_cells(36)),...
    mean(Dense_us_0point001_rep1.uninfected_cells(36),Dense_us_0point001_rep2.uninfected_cells(36)),...
    mean(Dense_us_0point01_rep1.uninfected_cells(36),Dense_us_0point01_rep2.uninfected_cells(36)),...
    mean(Dense_us_0point1_rep1.uninfected_cells(36),Dense_us_0point1_rep2.uninfected_cells(36)),...
    mean(Dense_us_1_rep1.uninfected_cells(36),Dense_us_1_rep2.uninfected_cells(36))]./dense_initial_cell_number*100,':','LineWidth',2)
l1 = errorbar([0.0001 0.001 0.01 0.1 1],[...
    mean(Dense_us_0point0001_rep1.uninfected_cells(36),Dense_us_0point0001_rep2.uninfected_cells(36)),...
    mean(Dense_us_0point001_rep1.uninfected_cells(36),Dense_us_0point001_rep2.uninfected_cells(36)),...
    mean(Dense_us_0point01_rep1.uninfected_cells(36),Dense_us_0point01_rep2.uninfected_cells(36)),...
    mean(Dense_us_0point1_rep1.uninfected_cells(36),Dense_us_0point1_rep2.uninfected_cells(36)),...
    mean(Dense_us_1_rep1.uninfected_cells(36),Dense_us_1_rep2.uninfected_cells(36))]./dense_initial_cell_number*100,[....
    std([Dense_us_0point0001_rep1.uninfected_cells(36),Dense_us_0point0001_rep2.uninfected_cells(36)]),...
    std([Dense_us_0point001_rep1.uninfected_cells(36),Dense_us_0point001_rep2.uninfected_cells(36)]),...
    std([Dense_us_0point01_rep1.uninfected_cells(36),Dense_us_0point01_rep2.uninfected_cells(36)]),...
    std([Dense_us_0point1_rep1.uninfected_cells(36),Dense_us_0point1_rep2.uninfected_cells(36)]),...
    std([Dense_us_1_rep1.uninfected_cells(36),Dense_us_1_rep2.uninfected_cells(36)])]./dense_initial_cell_number*100,'o','LineWidth',2,'MarkerSize',7)
ylabel('% initial GBM cells uninfected')
yyaxis right
plot([0.0001 0.001 0.01 0.1 1],[...
    mean(Sparse_us_0point0001_rep1.uninfected_cells(36),Sparse_us_0point0001_rep2.uninfected_cells(36)),...
    mean(Sparse_us_0point001_rep1.uninfected_cells(36),Sparse_us_0point001_rep2.uninfected_cells(36)),...
    mean(Sparse_us_0point01_rep1.uninfected_cells(36),Sparse_us_0point01_rep2.uninfected_cells(36)),...
    mean(Sparse_us_0point1_rep1.uninfected_cells(36),Sparse_us_0point1_rep2.uninfected_cells(36)),...
    mean(Sparse_us_1_rep1.uninfected_cells(36),Sparse_us_1_rep2.uninfected_cells(36))]./sparse_initial_cell_number*100,':','LineWidth',2)
l2 = errorbar([0.0001 0.001 0.01 0.1 1],[...
    mean(Sparse_us_0point0001_rep1.uninfected_cells(36),Sparse_us_0point0001_rep2.uninfected_cells(36)),...
    mean(Sparse_us_0point001_rep1.uninfected_cells(36),Sparse_us_0point001_rep2.uninfected_cells(36)),...
    mean(Sparse_us_0point01_rep1.uninfected_cells(36),Sparse_us_0point01_rep2.uninfected_cells(36)),...
    mean(Sparse_us_0point1_rep1.uninfected_cells(36),Sparse_us_0point1_rep2.uninfected_cells(36)),...
    mean(Sparse_us_1_rep1.uninfected_cells(36),Sparse_us_1_rep2.uninfected_cells(36))]./sparse_initial_cell_number*100,[...
    std([Sparse_us_0point0001_rep1.uninfected_cells(36),Sparse_us_0point0001_rep2.uninfected_cells(36)]),...
    std([Sparse_us_0point001_rep1.uninfected_cells(36),Sparse_us_0point001_rep2.uninfected_cells(36)]),...
    std([Sparse_us_0point01_rep1.uninfected_cells(36),Sparse_us_0point01_rep2.uninfected_cells(36)]),...
    std([Sparse_us_0point1_rep1.uninfected_cells(36),Sparse_us_0point1_rep2.uninfected_cells(36)]),...
    std([Sparse_us_1_rep1.uninfected_cells(36),Sparse_us_1_rep2.uninfected_cells(36)])]./sparse_initial_cell_number*100,'o','LineWidth',2,'MarkerSize',7)
set(gca,'xscale','log')
xlabel('Stroma uptake rate, u_s')
ylabel('% initial GBM cells uninfected')
set(gca,'FontSize',18)
legend([l1 l2],{'Dense','Sparse'})


figure
hold on 
yyaxis left
plot([0.0001 0.001 0.01 0.1 1],[...
    mean(Dense_us_0point0001_rep1.infected_cells(36),Dense_us_0point0001_rep2.infected_cells(36)),...
    mean(Dense_us_0point001_rep1.infected_cells(36),Dense_us_0point001_rep2.infected_cells(36)),...
    mean(Dense_us_0point01_rep1.infected_cells(36),Dense_us_0point01_rep2.infected_cells(36)),...
    mean(Dense_us_0point1_rep1.infected_cells(36),Dense_us_0point1_rep2.infected_cells(36)),...
    mean(Dense_us_1_rep1.infected_cells(36),Dense_us_1_rep2.infected_cells(36))],':','LineWidth',2)
l1 = errorbar([0.0001 0.001 0.01 0.1 1],[...
    mean(Dense_us_0point0001_rep1.infected_cells(36),Dense_us_0point0001_rep2.infected_cells(36)),...
    mean(Dense_us_0point001_rep1.infected_cells(36),Dense_us_0point001_rep2.infected_cells(36)),...
    mean(Dense_us_0point01_rep1.infected_cells(36),Dense_us_0point01_rep2.infected_cells(36)),...
    mean(Dense_us_0point1_rep1.infected_cells(36),Dense_us_0point1_rep2.infected_cells(36)),...
    mean(Dense_us_1_rep1.infected_cells(36),Dense_us_1_rep2.infected_cells(36))],[....
    std([Dense_us_0point0001_rep1.infected_cells(36),Dense_us_0point0001_rep2.infected_cells(36)]),...
    std([Dense_us_0point001_rep1.infected_cells(36),Dense_us_0point001_rep2.infected_cells(36)]),...
    std([Dense_us_0point01_rep1.infected_cells(36),Dense_us_0point01_rep2.infected_cells(36)]),...
    std([Dense_us_0point1_rep1.infected_cells(36),Dense_us_0point1_rep2.infected_cells(36)]),...
    std([Dense_us_1_rep1.infected_cells(36),Dense_us_1_rep2.infected_cells(36)])],'o','LineWidth',2,'MarkerSize',7)
ylabel('No. infected cells (virus>1)')
yyaxis right
plot([0.0001 0.001 0.01 0.1 1],[...
    mean(Sparse_us_0point0001_rep1.infected_cells(36),Sparse_us_0point0001_rep2.infected_cells(36)),...
    mean(Sparse_us_0point001_rep1.infected_cells(36),Sparse_us_0point001_rep2.infected_cells(36)),...
    mean(Sparse_us_0point01_rep1.infected_cells(36),Sparse_us_0point01_rep2.infected_cells(36)),...
    mean(Sparse_us_0point1_rep1.infected_cells(36),Sparse_us_0point1_rep2.infected_cells(36)),...
    mean(Sparse_us_1_rep1.infected_cells(36),Sparse_us_1_rep2.infected_cells(36))],':','LineWidth',2)
l2 = errorbar([0.0001 0.001 0.01 0.1 1],[...
    mean(Sparse_us_0point0001_rep1.infected_cells(36),Sparse_us_0point0001_rep2.infected_cells(36)),...
    mean(Sparse_us_0point001_rep1.infected_cells(36),Sparse_us_0point001_rep2.infected_cells(36)),...
    mean(Sparse_us_0point01_rep1.infected_cells(36),Sparse_us_0point01_rep2.infected_cells(36)),...
    mean(Sparse_us_0point1_rep1.infected_cells(36),Sparse_us_0point1_rep2.infected_cells(36)),...
    mean(Sparse_us_1_rep1.infected_cells(36),Sparse_us_1_rep2.infected_cells(36))],[...
    std([Sparse_us_0point0001_rep1.infected_cells(36),Sparse_us_0point0001_rep2.live_cells(36)]),...
    std([Sparse_us_0point001_rep1.infected_cells(36),Sparse_us_0point001_rep2.live_cells(36)]),...
    std([Sparse_us_0point01_rep1.infected_cells(36),Sparse_us_0point01_rep2.live_cells(36)]),...
    std([Sparse_us_0point1_rep1.infected_cells(36),Sparse_us_0point1_rep2.infected_cells(36)]),...
    std([Sparse_us_1_rep1.infected_cells(36),Sparse_us_1_rep2.infected_cells(36)])],'o','LineWidth',2,'MarkerSize',7)
set(gca,'xscale','log')
xlabel('Stroma uptake rate, u_s')
ylabel('No. infected cells (virus>1)')
set(gca,'FontSize',18)
legend([l1 l2],{'Dense','Sparse'})
